<?xml version="1.0" encoding="utf-8"?>
<NEKTAR>  
  <EXPANSIONS>    
    <E COMPOSITE="C[100,101,102]" NUMMODES="2" FIELDS="rho,rhou,rhov,E" TYPE="MODIFIED" />  
  </EXPANSIONS>
  
  <CONDITIONS>    
    <SOLVERINFO>
      <I PROPERTY="EQType"                VALUE="NavierStokesImplicitCFE"/>  
      <I PROPERTY="Projection"            VALUE="DisContinuous"          />
      <I PROPERTY="AdvectionType"         VALUE="WeakDG"                 />
      <I PROPERTY="DiffusionType"         VALUE="InteriorPenalty"        />
      <I PROPERTY="UpwindType"            VALUE="Roe"                    />
      <I PROPERTY="ViscosityType"         VALUE="Variable"               />
      <I PROPERTY="EquationOfState"       VALUE="IdealGas"              />
      <I PROPERTY="Driver"                VALUE="Standard"               />
      <I PROPERTY="AdvectionAdvancement"  VALUE="Implicit"               />
      <I PROPERTY="DiffusionAdvancement"  VALUE="Implicit"               />
      <I PROPERTY="TimeIntegrationMethod" VALUE="DIRKOrder2"             /> <!-- DIRKOrder2 = singly diagonally implicit Runge-Kutta method of order 2 !-->
      <I PROPERTY="ProblemType"           VALUE="General"                />
      <!--
      <I PROPERTY="ShockCaptureType"      VALUE="Physical"               />
      <I PROPERTY="Smoothing"             VALUE="C0"                     />
      -->
      <!--To avoid additional field output for now-->
      <I PROPERTY="OutputExtraFields"     VALUE="True"               />
    </SOLVERINFO>    

    <PARAMETERS>
     <!--General parameters-->
      <P> TimeStep = 0.0001 </P>
      <P> NumSteps        = 1e3      </P>
      <P> IO_CheckSteps   = NumSteps/100         </P> 
      <P> IO_InfoSteps    = 1       </P> 
      <P> IO_CFLSteps     = IO_InfoSteps         </P>
      <P> HistorySteps    = IO_InfoSteps </P>
      <P> EnergySteps     = IO_InfoSteps * 10</P>

    <!-- Iteration parameters-->
      <P> PreconMatFreezNumb        = 100               </P>
      <P> NonlinIterTolRelativeL2   = 1.0e-2            </P>
      <P> LinSysRelativeTolInNonlin = 1.0e-2            </P>  
      <P> NewtonAbsoluteIteTol      = 1.0e-10           </P>    
      <P> PreconItsStep             = 7                 </P>
      <P> NekLinSysMaxIterations    = 100                </P>
    
      <!-- Parameters for the simulation -->
      <!-- To understand the formulas in the parameters, please refer to the file docs/20250414_Blasius_formulas.md -->
      <!-- CHANGE THIS BEFORE RUNNING THE SIMULATION -->
      <!-- it has to match the definition of x0 (negated) in the .geo file -->
      <!-- ........................................... -->
      <!-- ........................................... -->
      <!-- ........................................... -->
      <p> lengthBeforeGap       = -100 </p> <!-- in terms of deltaStar_leadingEdge !-->
      <!-- ........................................... -->
      <!-- ........................................... -->
      <!-- ........................................... -->
      <p> C                     = 1.7207876575205 </p> <!-- number from wiki !-->
      <p> uInf                  = 1                   </p>
      <p> deltaStar_le          = 1  </p> 
      <P> Re_deltaStar_le       = 1000       </P> <!-- Reynolds number based on deltaStar_leadingEdge !-->
      <P> deltaStar_BC          = sqrt(1+lengthBeforeGap*C^2/Re_deltaStar_le) </P> 
      <p> vInf                  = 0.5*uInf*C/(Re_deltaStar_le * deltaStar_BC) </p> 
      <!-- Flow parameters -->  
      <P> Ma                    = 0.8                       </P> <!-- REMEBER CHANGING BLASIUS PROFILE IF CHANGING THIS !-->
      <P> Pr                    = 0.72                     </P> <!-- around 0.71 and 0.72 for air !-->
      <P> Gamma                 = 1.4                       </P>     
      <P> rhoInf                = 1.0                       </P>
      <P> TInf                  = 1.0                       </P> 
      <P> cInf                  = uInf/Ma                   </P>
      <P> GasConstant           = cInf^2/(Gamma * TInf)     </P>
      <P> pInf                  = rhoInf*GasConstant*TInf   </P>
      <P> mu                    = rhoInf*uInf*deltaStar_le/Re_deltaStar_le </P>
      <P> Twall                 = TInf                      </P>


      <P> rhouInf              = rhoInf*uInf                </P>
      <P> rhovInf              = rhoInf*vInf                </P>
      <P> E0Inf                = pInf/(Gamma-1) </P>
      <P> E1Inf                = 0.5 * rhoInf*uInf^2                      </P>
      <P> E2Inf                = 0.125 * rhoInf*uInf^2*(C/(Re_deltaStar_le * deltaStar_BC))^2 </P>

      <P> etaMax                = 11.3                      </P>  <!-- based on python plotting script. It fits better than etaMax=10, the endpoint of the simulation, both for u and v !-->
      <P> y2eta                 = C/deltaStar_BC   </P> 
      <P> yMax        = etaMax/y2eta             </P> <!--[m]-->  

      <p> a1_rho = -0.030672041511361024 </p>
      <p> a2_rho = 225.04976697292403 </p>
      <p> a3_rho = -80.37408648381619 </p>
      <p> a4_rho = -103.86695044534964 </p>
      <p> a5_rho = 48.075638228068534 </p>
      <p> a6_rho = -5.4245240007638875 </p>
      <p> a7_rho = -0.6070941783412032 </p>
      <p> a8_rho = 0.21308418351375513 </p>
      <p> a9_rho = -0.0221168287470335 </p>
      <p> a10_rho = 0.0010580339931198642 </p>
      <p> a11_rho = -1.9874996946359057e-05 </p>
      <p> b1_rho = -6982.065628270814 </p>
      <p> b2_rho = 1.1963529364752352 </p>
      <p> b3_rho = 3385.7582012117314 </p>
      <p> b4_rho = -277.5290079449125 </p>
      <p> b5_rho = -93.3976595445126 </p>
      <p> b6_rho = 106.80479136556833 </p>
      <p> b7_rho = -28.073798379978825 </p>
      <p> b8_rho = 6.74360610502256 </p>
      <p> b9_rho = -0.840040935222796 </p>
      <p> b10_rho = 0.05896833583601069 </p>
      <p> a1_rhou = 0.3394767222646389 </p>
      <p> a2_rhou = 14279.191267214957 </p>
      <p> a3_rhou = -549.693211625743 </p>
      <p> a4_rhou = 196.42609363105944 </p>
      <p> a5_rhou = 76.59761351216508 </p>
      <p> a6_rhou = -5.863244115535414 </p>
      <p> a7_rhou = 7.515523971977415 </p>
      <p> a8_rhou = -2.018864156396207 </p>
      <p> a9_rhou = 0.5763755735050864 </p>
      <p> a10_rhou = -0.07867337780412623 </p>
      <p> a11_rhou = 0.006803292881224969 </p>
      <p> b1_rhou = 42794.52443863968 </p>
      <p> b2_rhou = 67.05592019716671 </p>
      <p> b3_rhou = 20.214154929075594 </p>
      <p> b4_rhou = 551.4524925398267 </p>
      <p> b5_rhou = -0.11956244205846779 </p>
      <p> b6_rhou = 5.2430401597979746 </p>
      <p> b7_rhou = 6.017653079277642 </p>
      <p> b8_rhou = -1.8770364220556144 </p>
      <p> b9_rhou = 0.5691072949134913 </p>
      <p> b10_rhou = -0.07852310127710013 </p>
      <p> b11_rhou = 0.006803292881224969 </p>
      <p> a1_rhov = -0.003957626584195678 </p>
      <p> a2_rhov = 0.2863463808946219 </p>
      <p> a3_rhov = 1069.6486884786543 </p>
      <p> a4_rhov = 229.08178152485158 </p>
      <p> a5_rhov = -0.9717492278600598 </p>
      <p> a6_rhov = -38.56767327567924 </p>
      <p> a7_rhov = 19.414685728859812 </p>
      <p> a8_rhov = -4.659330398442297 </p>
      <p> a9_rhov = 0.7794011458635737 </p>
      <p> a10_rhov = -0.07811838137566061 </p>
      <p> a11_rhov = 0.004271586932255039 </p>
      <p> b1_rhov = 6417.6462027684 </p>
      <p> b2_rhov = 1623.1241314324834 </p>
      <p> b3_rhov = 1.4012772228755699 </p>
      <p> b4_rhov = -252.70447486676306 </p>
      <p> b5_rhov = 184.52280623101217 </p>
      <p> b6_rhov = -55.45230884183481 </p>
      <p> b7_rhov = 14.117346373380574 </p>
      <p> b8_rhov = -2.7709308226451483 </p>
      <p> b9_rhov = 0.4381159789762011 </p>
      <p> b10_rhov = -0.04344207336958269 </p>
      <p> b11_rhov = 0.0023720990410863326 </p>
      <p> a1_E1 = -0.009949940206461954 </p>
      <p> a2_E1 = 0.4127233659866393 </p>
      <p> a3_E1 = 4632.8295179957495 </p>
      <p> a4_E1 = 66.96054630155699 </p>
      <p> a5_E1 = 48.346749552471564 </p>
      <p> a6_E1 = -91.47160182882092 </p>
      <p> a7_E1 = 50.81543391364358 </p>
      <p> a8_E1 = -12.744130619354245 </p>
      <p> a9_E1 = 2.2901230145066163 </p>
      <p> a10_E1 = -0.24589739387224205 </p>
      <p> a11_E1 = 0.014639269592755686 </p>
      <p> b1_E1 = 41634.59550284955 </p>
      <p> b2_E1 = 2506.4538223584345 </p>
      <p> b3_E1 = 111.81498350948135 </p>
      <p> b4_E1 = -518.2025084388049 </p>
      <p> b5_E1 = 689.7469571960326 </p>
      <p> b6_E1 = -235.68300102674365 </p>
      <p> b7_E1 = 66.99184052759959 </p>
      <p> b8_E1 = -13.751232322973912 </p>
      <p> b9_E1 = 2.3234020785194835 </p>
      <p> b10_E1 = -0.24635298052411025 </p>
      <p> b11_E1 = 0.014639269592755686 </p>
      <p> a1_E2 = 0.0037780090442646277 </p>
      <p> a2_E2 = -0.14746550120138677 </p>
      <p> a3_E2 = 1.4009946852034236 </p>
      <p> a4_E2 = -5.575419582770366 </p>
      <p> a5_E2 = 415.2542302979404 </p>
      <p> a6_E2 = -197.13402453761313 </p>
      <p> a7_E2 = 70.50316983423667 </p>
      <p> a8_E2 = -18.54020669701465 </p>
      <p> a9_E2 = 3.4089704188734022 </p>
      <p> a10_E2 = -0.3609833854447406 </p>
      <p> a11_E2 = 0.018443688563882177 </p>
      <p> b1_E2 = 14499.341206857007 </p>
      <p> b2_E2 = -5812.333260493347 </p>
      <p> b3_E2 = 1535.8861063313568 </p>
      <p> b4_E2 = -1.3351722170557532 </p>
      <p> b5_E2 = -46.038785026507426 </p>
      <p> b6_E2 = -4.561141840350669 </p>
      <p> b7_E2 = 13.324876413765084 </p>
      <p> b8_E2 = -5.037655436237798 </p>
      <p> b9_E2 = 1.0225089699482899 </p>
      <p> b10_E2 = -0.11081852569540411 </p>
      <p> b11_E2 = 0.005687676902594551 </p>
    </PARAMETERS>

    <VARIABLES>
      <V ID="0"> rho  </V>
      <V ID="1"> rhou </V>
      <V ID="2"> rhov </V>
      <V ID="3"> E    </V>
    </VARIABLES>
     
    <BOUNDARYREGIONS>
      <B ID="0"> C[1] </B>    <!-- inlet !-->  
      <B ID="1"> C[2] </B>    <!-- outlet !-->
      <B ID="2"> C[3] </B>    <!-- top !-->
      <B ID="3"> C[4] </B>    <!-- bottom + left & right gap walls !-->
    </BOUNDARYREGIONS>    

    <BOUNDARYCONDITIONS>
    <REGION REF="0">  <!-- inlet !-->                     
        <D VAR="rho" VALUE="rhoInf + ( 
                   (
                     (a1_rho*(0.0046804544668539675 + 1.0014543752094833 * y - 0.045331069603443575 * tanh(0.635527485713853 * y))^1 + a2_rho*(0.0046804544668539675 + 1.0014543752094833 * y - 0.045331069603443575 * tanh(0.635527485713853 * y))^2 + a3_rho*(0.0046804544668539675 + 1.0014543752094833 * y - 0.045331069603443575 * tanh(0.635527485713853 * y))^3 + a4_rho*(0.0046804544668539675 + 1.0014543752094833 * y - 0.045331069603443575 * tanh(0.635527485713853 * y))^4 + a5_rho*(0.0046804544668539675 + 1.0014543752094833 * y - 0.045331069603443575 * tanh(0.635527485713853 * y))^5 + a6_rho*(0.0046804544668539675 + 1.0014543752094833 * y - 0.045331069603443575 * tanh(0.635527485713853 * y))^6 + a7_rho*(0.0046804544668539675 + 1.0014543752094833 * y - 0.045331069603443575 * tanh(0.635527485713853 * y))^7 + a8_rho*(0.0046804544668539675 + 1.0014543752094833 * y - 0.045331069603443575 * tanh(0.635527485713853 * y))^8 + a9_rho*(0.0046804544668539675 + 1.0014543752094833 * y - 0.045331069603443575 * tanh(0.635527485713853 * y))^9 + a10_rho*(0.0046804544668539675 + 1.0014543752094833 * y - 0.045331069603443575 * tanh(0.635527485713853 * y))^10 + a11_rho*(0.0046804544668539675 + 1.0014543752094833 * y - 0.045331069603443575 * tanh(0.635527485713853 * y))^11) / 
                     (1 + b1_rho*(0.0046804544668539675 + 1.0014543752094833 * y - 0.045331069603443575 * tanh(0.635527485713853 * y))^1 + b2_rho*(0.0046804544668539675 + 1.0014543752094833 * y - 0.045331069603443575 * tanh(0.635527485713853 * y))^2 + b3_rho*(0.0046804544668539675 + 1.0014543752094833 * y - 0.045331069603443575 * tanh(0.635527485713853 * y))^3 + b4_rho*(0.0046804544668539675 + 1.0014543752094833 * y - 0.045331069603443575 * tanh(0.635527485713853 * y))^4 + b5_rho*(0.0046804544668539675 + 1.0014543752094833 * y - 0.045331069603443575 * tanh(0.635527485713853 * y))^5 + b6_rho*(0.0046804544668539675 + 1.0014543752094833 * y - 0.045331069603443575 * tanh(0.635527485713853 * y))^6 + b7_rho*(0.0046804544668539675 + 1.0014543752094833 * y - 0.045331069603443575 * tanh(0.635527485713853 * y))^7 + b8_rho*(0.0046804544668539675 + 1.0014543752094833 * y - 0.045331069603443575 * tanh(0.635527485713853 * y))^8 + b9_rho*(0.0046804544668539675 + 1.0014543752094833 * y - 0.045331069603443575 * tanh(0.635527485713853 * y))^9 + b10_rho*(0.0046804544668539675 + 1.0014543752094833 * y - 0.045331069603443575 * tanh(0.635527485713853 * y))^10)
                   ) * (y<yMax) + 
                   (
                     (a1_rho*etaMax^1 + a2_rho*etaMax^2 + a3_rho*etaMax^3 + a4_rho*etaMax^4 + a5_rho*etaMax^5 + a6_rho*etaMax^6 + a7_rho*etaMax^7 + a8_rho*etaMax^8 + a9_rho*etaMax^9 + a10_rho*etaMax^10 + a11_rho*etaMax^11) / 
                     (1 + b1_rho*etaMax^1 + b2_rho*etaMax^2 + b3_rho*etaMax^3 + b4_rho*etaMax^4 + b5_rho*etaMax^5 + b6_rho*etaMax^6 + b7_rho*etaMax^7 + b8_rho*etaMax^8 + b9_rho*etaMax^9 + b10_rho*etaMax^10)
                   ) * (y>=yMax))" />
        <D VAR="rhou" VALUE="rhouInf * ( 
                   (
                     (a1_rhou*(0.0046804544668539675 + 1.0014543752094833 * y - 0.045331069603443575 * tanh(0.635527485713853 * y))^1 + a2_rhou*(0.0046804544668539675 + 1.0014543752094833 * y - 0.045331069603443575 * tanh(0.635527485713853 * y))^2 + a3_rhou*(0.0046804544668539675 + 1.0014543752094833 * y - 0.045331069603443575 * tanh(0.635527485713853 * y))^3 + a4_rhou*(0.0046804544668539675 + 1.0014543752094833 * y - 0.045331069603443575 * tanh(0.635527485713853 * y))^4 + a5_rhou*(0.0046804544668539675 + 1.0014543752094833 * y - 0.045331069603443575 * tanh(0.635527485713853 * y))^5 + a6_rhou*(0.0046804544668539675 + 1.0014543752094833 * y - 0.045331069603443575 * tanh(0.635527485713853 * y))^6 + a7_rhou*(0.0046804544668539675 + 1.0014543752094833 * y - 0.045331069603443575 * tanh(0.635527485713853 * y))^7 + a8_rhou*(0.0046804544668539675 + 1.0014543752094833 * y - 0.045331069603443575 * tanh(0.635527485713853 * y))^8 + a9_rhou*(0.0046804544668539675 + 1.0014543752094833 * y - 0.045331069603443575 * tanh(0.635527485713853 * y))^9 + a10_rhou*(0.0046804544668539675 + 1.0014543752094833 * y - 0.045331069603443575 * tanh(0.635527485713853 * y))^10 + a11_rhou*(0.0046804544668539675 + 1.0014543752094833 * y - 0.045331069603443575 * tanh(0.635527485713853 * y))^11) / 
                     (1 + b1_rhou*(0.0046804544668539675 + 1.0014543752094833 * y - 0.045331069603443575 * tanh(0.635527485713853 * y))^1 + b2_rhou*(0.0046804544668539675 + 1.0014543752094833 * y - 0.045331069603443575 * tanh(0.635527485713853 * y))^2 + b3_rhou*(0.0046804544668539675 + 1.0014543752094833 * y - 0.045331069603443575 * tanh(0.635527485713853 * y))^3 + b4_rhou*(0.0046804544668539675 + 1.0014543752094833 * y - 0.045331069603443575 * tanh(0.635527485713853 * y))^4 + b5_rhou*(0.0046804544668539675 + 1.0014543752094833 * y - 0.045331069603443575 * tanh(0.635527485713853 * y))^5 + b6_rhou*(0.0046804544668539675 + 1.0014543752094833 * y - 0.045331069603443575 * tanh(0.635527485713853 * y))^6 + b7_rhou*(0.0046804544668539675 + 1.0014543752094833 * y - 0.045331069603443575 * tanh(0.635527485713853 * y))^7 + b8_rhou*(0.0046804544668539675 + 1.0014543752094833 * y - 0.045331069603443575 * tanh(0.635527485713853 * y))^8 + b9_rhou*(0.0046804544668539675 + 1.0014543752094833 * y - 0.045331069603443575 * tanh(0.635527485713853 * y))^9 + b10_rhou*(0.0046804544668539675 + 1.0014543752094833 * y - 0.045331069603443575 * tanh(0.635527485713853 * y))^10 + b11_rhou*(0.0046804544668539675 + 1.0014543752094833 * y - 0.045331069603443575 * tanh(0.635527485713853 * y))^11)
                   ) * (y<yMax) + 
                   (
                     (a1_rhou*etaMax^1 + a2_rhou*etaMax^2 + a3_rhou*etaMax^3 + a4_rhou*etaMax^4 + a5_rhou*etaMax^5 + a6_rhou*etaMax^6 + a7_rhou*etaMax^7 + a8_rhou*etaMax^8 + a9_rhou*etaMax^9 + a10_rhou*etaMax^10 + a11_rhou*etaMax^11) / 
                     (1 + b1_rhou*etaMax^1 + b2_rhou*etaMax^2 + b3_rhou*etaMax^3 + b4_rhou*etaMax^4 + b5_rhou*etaMax^5 + b6_rhou*etaMax^6 + b7_rhou*etaMax^7 + b8_rhou*etaMax^8 + b9_rhou*etaMax^9 + b10_rhou*etaMax^10 + b11_rhou*etaMax^11)
                   ) * (y>=yMax))" />
        <D VAR="rhov" VALUE="rhovInf * ( 
                   (
                     (a1_rhov*(0.0046804544668539675 + 1.0014543752094833 * y - 0.045331069603443575 * tanh(0.635527485713853 * y))^1 + a2_rhov*(0.0046804544668539675 + 1.0014543752094833 * y - 0.045331069603443575 * tanh(0.635527485713853 * y))^2 + a3_rhov*(0.0046804544668539675 + 1.0014543752094833 * y - 0.045331069603443575 * tanh(0.635527485713853 * y))^3 + a4_rhov*(0.0046804544668539675 + 1.0014543752094833 * y - 0.045331069603443575 * tanh(0.635527485713853 * y))^4 + a5_rhov*(0.0046804544668539675 + 1.0014543752094833 * y - 0.045331069603443575 * tanh(0.635527485713853 * y))^5 + a6_rhov*(0.0046804544668539675 + 1.0014543752094833 * y - 0.045331069603443575 * tanh(0.635527485713853 * y))^6 + a7_rhov*(0.0046804544668539675 + 1.0014543752094833 * y - 0.045331069603443575 * tanh(0.635527485713853 * y))^7 + a8_rhov*(0.0046804544668539675 + 1.0014543752094833 * y - 0.045331069603443575 * tanh(0.635527485713853 * y))^8 + a9_rhov*(0.0046804544668539675 + 1.0014543752094833 * y - 0.045331069603443575 * tanh(0.635527485713853 * y))^9 + a10_rhov*(0.0046804544668539675 + 1.0014543752094833 * y - 0.045331069603443575 * tanh(0.635527485713853 * y))^10 + a11_rhov*(0.0046804544668539675 + 1.0014543752094833 * y - 0.045331069603443575 * tanh(0.635527485713853 * y))^11) / 
                     (1 + b1_rhov*(0.0046804544668539675 + 1.0014543752094833 * y - 0.045331069603443575 * tanh(0.635527485713853 * y))^1 + b2_rhov*(0.0046804544668539675 + 1.0014543752094833 * y - 0.045331069603443575 * tanh(0.635527485713853 * y))^2 + b3_rhov*(0.0046804544668539675 + 1.0014543752094833 * y - 0.045331069603443575 * tanh(0.635527485713853 * y))^3 + b4_rhov*(0.0046804544668539675 + 1.0014543752094833 * y - 0.045331069603443575 * tanh(0.635527485713853 * y))^4 + b5_rhov*(0.0046804544668539675 + 1.0014543752094833 * y - 0.045331069603443575 * tanh(0.635527485713853 * y))^5 + b6_rhov*(0.0046804544668539675 + 1.0014543752094833 * y - 0.045331069603443575 * tanh(0.635527485713853 * y))^6 + b7_rhov*(0.0046804544668539675 + 1.0014543752094833 * y - 0.045331069603443575 * tanh(0.635527485713853 * y))^7 + b8_rhov*(0.0046804544668539675 + 1.0014543752094833 * y - 0.045331069603443575 * tanh(0.635527485713853 * y))^8 + b9_rhov*(0.0046804544668539675 + 1.0014543752094833 * y - 0.045331069603443575 * tanh(0.635527485713853 * y))^9 + b10_rhov*(0.0046804544668539675 + 1.0014543752094833 * y - 0.045331069603443575 * tanh(0.635527485713853 * y))^10 + b11_rhov*(0.0046804544668539675 + 1.0014543752094833 * y - 0.045331069603443575 * tanh(0.635527485713853 * y))^11)
                   ) * (y<yMax) + 
                   (
                     (a1_rhov*etaMax^1 + a2_rhov*etaMax^2 + a3_rhov*etaMax^3 + a4_rhov*etaMax^4 + a5_rhov*etaMax^5 + a6_rhov*etaMax^6 + a7_rhov*etaMax^7 + a8_rhov*etaMax^8 + a9_rhov*etaMax^9 + a10_rhov*etaMax^10 + a11_rhov*etaMax^11) / 
                     (1 + b1_rhov*etaMax^1 + b2_rhov*etaMax^2 + b3_rhov*etaMax^3 + b4_rhov*etaMax^4 + b5_rhov*etaMax^5 + b6_rhov*etaMax^6 + b7_rhov*etaMax^7 + b8_rhov*etaMax^8 + b9_rhov*etaMax^9 + b10_rhov*etaMax^10 + b11_rhov*etaMax^11)
                   ) * (y>=yMax))" />
        <D VAR="E" VALUE="E0Inf + E1Inf * (
                   (
                     (a1_E1*(0.0046804544668539675 + 1.0014543752094833 * y - 0.045331069603443575 * tanh(0.635527485713853 * y))^1 + a2_E1*(0.0046804544668539675 + 1.0014543752094833 * y - 0.045331069603443575 * tanh(0.635527485713853 * y))^2 + a3_E1*(0.0046804544668539675 + 1.0014543752094833 * y - 0.045331069603443575 * tanh(0.635527485713853 * y))^3 + a4_E1*(0.0046804544668539675 + 1.0014543752094833 * y - 0.045331069603443575 * tanh(0.635527485713853 * y))^4 + a5_E1*(0.0046804544668539675 + 1.0014543752094833 * y - 0.045331069603443575 * tanh(0.635527485713853 * y))^5 + a6_E1*(0.0046804544668539675 + 1.0014543752094833 * y - 0.045331069603443575 * tanh(0.635527485713853 * y))^6 + a7_E1*(0.0046804544668539675 + 1.0014543752094833 * y - 0.045331069603443575 * tanh(0.635527485713853 * y))^7 + a8_E1*(0.0046804544668539675 + 1.0014543752094833 * y - 0.045331069603443575 * tanh(0.635527485713853 * y))^8 + a9_E1*(0.0046804544668539675 + 1.0014543752094833 * y - 0.045331069603443575 * tanh(0.635527485713853 * y))^9 + a10_E1*(0.0046804544668539675 + 1.0014543752094833 * y - 0.045331069603443575 * tanh(0.635527485713853 * y))^10 + a11_E1*(0.0046804544668539675 + 1.0014543752094833 * y - 0.045331069603443575 * tanh(0.635527485713853 * y))^11) / 
                     (1 + b1_E1*(0.0046804544668539675 + 1.0014543752094833 * y - 0.045331069603443575 * tanh(0.635527485713853 * y))^1 + b2_E1*(0.0046804544668539675 + 1.0014543752094833 * y - 0.045331069603443575 * tanh(0.635527485713853 * y))^2 + b3_E1*(0.0046804544668539675 + 1.0014543752094833 * y - 0.045331069603443575 * tanh(0.635527485713853 * y))^3 + b4_E1*(0.0046804544668539675 + 1.0014543752094833 * y - 0.045331069603443575 * tanh(0.635527485713853 * y))^4 + b5_E1*(0.0046804544668539675 + 1.0014543752094833 * y - 0.045331069603443575 * tanh(0.635527485713853 * y))^5 + b6_E1*(0.0046804544668539675 + 1.0014543752094833 * y - 0.045331069603443575 * tanh(0.635527485713853 * y))^6 + b7_E1*(0.0046804544668539675 + 1.0014543752094833 * y - 0.045331069603443575 * tanh(0.635527485713853 * y))^7 + b8_E1*(0.0046804544668539675 + 1.0014543752094833 * y - 0.045331069603443575 * tanh(0.635527485713853 * y))^8 + b9_E1*(0.0046804544668539675 + 1.0014543752094833 * y - 0.045331069603443575 * tanh(0.635527485713853 * y))^9 + b10_E1*(0.0046804544668539675 + 1.0014543752094833 * y - 0.045331069603443575 * tanh(0.635527485713853 * y))^10 + b11_E1*(0.0046804544668539675 + 1.0014543752094833 * y - 0.045331069603443575 * tanh(0.635527485713853 * y))^11)
                   ) * (y<yMax) + 
                   (
                     (a1_E1*etaMax^1 + a2_E1*etaMax^2 + a3_E1*etaMax^3 + a4_E1*etaMax^4 + a5_E1*etaMax^5 + a6_E1*etaMax^6 + a7_E1*etaMax^7 + a8_E1*etaMax^8 + a9_E1*etaMax^9 + a10_E1*etaMax^10 + a11_E1*etaMax^11) / 
                     (1 + b1_E1*etaMax^1 + b2_E1*etaMax^2 + b3_E1*etaMax^3 + b4_E1*etaMax^4 + b5_E1*etaMax^5 + b6_E1*etaMax^6 + b7_E1*etaMax^7 + b8_E1*etaMax^8 + b9_E1*etaMax^9 + b10_E1*etaMax^10 + b11_E1*etaMax^11)
                   ) * (y>=yMax)) + E2Inf * (
                   (
                     (a1_E2*(0.0046804544668539675 + 1.0014543752094833 * y - 0.045331069603443575 * tanh(0.635527485713853 * y))^1 + a2_E2*(0.0046804544668539675 + 1.0014543752094833 * y - 0.045331069603443575 * tanh(0.635527485713853 * y))^2 + a3_E2*(0.0046804544668539675 + 1.0014543752094833 * y - 0.045331069603443575 * tanh(0.635527485713853 * y))^3 + a4_E2*(0.0046804544668539675 + 1.0014543752094833 * y - 0.045331069603443575 * tanh(0.635527485713853 * y))^4 + a5_E2*(0.0046804544668539675 + 1.0014543752094833 * y - 0.045331069603443575 * tanh(0.635527485713853 * y))^5 + a6_E2*(0.0046804544668539675 + 1.0014543752094833 * y - 0.045331069603443575 * tanh(0.635527485713853 * y))^6 + a7_E2*(0.0046804544668539675 + 1.0014543752094833 * y - 0.045331069603443575 * tanh(0.635527485713853 * y))^7 + a8_E2*(0.0046804544668539675 + 1.0014543752094833 * y - 0.045331069603443575 * tanh(0.635527485713853 * y))^8 + a9_E2*(0.0046804544668539675 + 1.0014543752094833 * y - 0.045331069603443575 * tanh(0.635527485713853 * y))^9 + a10_E2*(0.0046804544668539675 + 1.0014543752094833 * y - 0.045331069603443575 * tanh(0.635527485713853 * y))^10 + a11_E2*(0.0046804544668539675 + 1.0014543752094833 * y - 0.045331069603443575 * tanh(0.635527485713853 * y))^11) / 
                     (1 + b1_E2*(0.0046804544668539675 + 1.0014543752094833 * y - 0.045331069603443575 * tanh(0.635527485713853 * y))^1 + b2_E2*(0.0046804544668539675 + 1.0014543752094833 * y - 0.045331069603443575 * tanh(0.635527485713853 * y))^2 + b3_E2*(0.0046804544668539675 + 1.0014543752094833 * y - 0.045331069603443575 * tanh(0.635527485713853 * y))^3 + b4_E2*(0.0046804544668539675 + 1.0014543752094833 * y - 0.045331069603443575 * tanh(0.635527485713853 * y))^4 + b5_E2*(0.0046804544668539675 + 1.0014543752094833 * y - 0.045331069603443575 * tanh(0.635527485713853 * y))^5 + b6_E2*(0.0046804544668539675 + 1.0014543752094833 * y - 0.045331069603443575 * tanh(0.635527485713853 * y))^6 + b7_E2*(0.0046804544668539675 + 1.0014543752094833 * y - 0.045331069603443575 * tanh(0.635527485713853 * y))^7 + b8_E2*(0.0046804544668539675 + 1.0014543752094833 * y - 0.045331069603443575 * tanh(0.635527485713853 * y))^8 + b9_E2*(0.0046804544668539675 + 1.0014543752094833 * y - 0.045331069603443575 * tanh(0.635527485713853 * y))^9 + b10_E2*(0.0046804544668539675 + 1.0014543752094833 * y - 0.045331069603443575 * tanh(0.635527485713853 * y))^10 + b11_E2*(0.0046804544668539675 + 1.0014543752094833 * y - 0.045331069603443575 * tanh(0.635527485713853 * y))^11)
                   ) * (y<yMax) + 
                   (
                     (a1_E2*etaMax^1 + a2_E2*etaMax^2 + a3_E2*etaMax^3 + a4_E2*etaMax^4 + a5_E2*etaMax^5 + a6_E2*etaMax^6 + a7_E2*etaMax^7 + a8_E2*etaMax^8 + a9_E2*etaMax^9 + a10_E2*etaMax^10 + a11_E2*etaMax^11) / 
                     (1 + b1_E2*etaMax^1 + b2_E2*etaMax^2 + b3_E2*etaMax^3 + b4_E2*etaMax^4 + b5_E2*etaMax^5 + b6_E2*etaMax^6 + b7_E2*etaMax^7 + b8_E2*etaMax^8 + b9_E2*etaMax^9 + b10_E2*etaMax^10 + b11_E2*etaMax^11)
                   ) * (y>=yMax))" />
      </REGION>

      <REGION REF="1">  <!-- outlet !-->            
        <D VAR="rho"  USERDEFINEDTYPE="PressureOutflow" VALUE="0" />
        <D VAR="rhou" USERDEFINEDTYPE="PressureOutflow" VALUE="0" />
        <D VAR="rhov" USERDEFINEDTYPE="PressureOutflow" VALUE="0" />
        <D VAR="E"    USERDEFINEDTYPE="PressureOutflow" VALUE="pInf" />
      </REGION>
            
      <REGION REF="2">   <!-- top = far-field !-->
        <!-- I do it like that in order to avoid discontinuities in the velocity field at the top boundary, the error is of the order of 10^-7 for u and 10^-10 for v ! -->
        <D VAR="rho" VALUE="rhoInf" />
        <D VAR="rhou" VALUE="rhoInf*uInf" />
        <D VAR="rhov" VALUE="rhoInf*0.5*uInf*C^2/(Re_deltaStar_le * sqrt(1+x*C^2/Re_deltaStar_le))" />
        <D VAR="E" VALUE="pInf/(Gamma-1) + 0.5*rhoInf*uInf^2*(1 + 0.25*C^4/(Re_deltaStar_le^2 * (1+x*C^2/Re_deltaStar_le)))" />
      </REGION>

      <REGION REF="3">  <!-- bottom = wall no slip !-->  
        <D VAR="rho"  USERDEFINEDTYPE="WallViscous" VALUE="0" />
        <D VAR="rhou" USERDEFINEDTYPE="WallViscous" VALUE="0" />
        <D VAR="rhov" USERDEFINEDTYPE="WallViscous" VALUE="0" />        
        <D VAR="E"    USERDEFINEDTYPE="WallViscous" VALUE="0" />
      </REGION>    
    </BOUNDARYCONDITIONS>

    <FUNCTION NAME="InitialConditions">
      <E VAR="rho"  VALUE="0.0"   />
      <E VAR="rhou" VALUE="0.0"   />
      <E VAR="rhov" VALUE="0.0"   />
      <E VAR="E"    VALUE="0.0"   />
    </FUNCTION> 
     </CONDITIONS>
  <FILTERS>

    <FILTER TYPE="ModalEnergy">
      <PARAM NAME="OutputFile">EnergyFile</PARAM>
      <PARAM NAME="OutputFrequency">EnergySteps</PARAM>
    </FILTER>

    <FILTER TYPE="HistoryPoints">
      <PARAM NAME="OutputFile">HistoryPoints</PARAM>
      <PARAM NAME="OutputFrequency">HistorySteps</PARAM>
      <PARAM NAME="Points">
    -100 1 0
    -75 1 0
    -50 1 0
    -35 1 0
    -25 1 0
    -15 1 0
    -10 1 0
    -5 1 0
    0 1 0
    5 1 0
    5 -2.00000000000000000000 0
    10 1 0
    15 1 0
    20 1 0
    25 1 0
    35 1 0
    45 1 0
    60 1 0
    85 1 0
    110 1 0
    135 1 0
    160 1 0
    185 1 0
    210 1 0
    235 1 0
    260 1 0
    285 1 0
    310 1 0
    335 1 0
    360 1 0
    385 1 0
    410 1 0
    435 1 0
    460 1 0
    485 1 0
    510 1 0
    535 1 0
    560 1 0
    585 1 0
    610 1 0
    635 1 0
    660 1 0
    685 1 0
    710 1 0
    735 1 0
    760 1 0
    785 1 0
    810 1 0
    835 1 0
    860 1 0
    885 1 0
    910 1 0
    935 1 0
    960 1 0
    985 1 0
    1010 1 0
      </PARAM>
    </FILTER>
  </FILTERS>

</NEKTAR>

